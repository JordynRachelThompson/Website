@model IEnumerable<MyWebsite.Models.BudgetProject.BudgetItems>
@using MyWebsite.Models.BudgetProject

@{  
    string user = User.Identity.Name;
    int budgetMonth = DateTime.Now.Month;
}


<div style="text-align:center; margin-top:80px;"><p style="text-align:center;">@Html.Partial("_LoginPartial", 1)</p></div>
<h3 style="text-align:center; margin-top:100px;">The Painless Budget</h3>
<div style="border-bottom: 1px solid #cfd8dc;"></div>


<div class="container">
    <div style="margin-top:25px; text-align:center;">
        <a href='@Url.Action("Index", "Budgets", new { userName = user })'; class="waves-effect waves-light btn-large sharpCorners lightBrown-hover grey darken-4" style="font-weight:bold; font-size:20px;"><i class="material-icons left">arrow_back</i>Return to Budget</a>
        @*@Html.ActionLink("Return to Budget", "Index", "Budgets", new { userName = user }, new { @class = "grey-button" })*@
    </div>
    <h4 style="margin-top:55px; margin-bottom:25px; font-weight:bold; color:#cfd8dc; text-align:center">Add Transaction</h4>
    @*Validation Errors*@
    <div class="container" style="margin-top:20px;">
        <p style="font-weight:bold; color:#D50000; text-align:center">@ViewBag.typeError</p>
        <p style="font-weight:bold; color:#D50000; text-align:center">@ViewBag.costError</p>
        <p style="text-align:center; font-weight:bold; color:#81cac4; margin-top:10px;">@TempData["successTransactionAdded"]</p>
    </div>
    <div class="row">
        <div class="col s12 m12 l4"></div>
        <form asp-action="AddTransaction" class="col s12 m12 l4 center" style="background-color:#212121">
            <div class="input-field col s12" style="margin-bottom:35px; margin-top:35px;">
                <select name="TypeOfBudget">
                    <option value="0" disabled selected>Select a Category </option>
                    <option value="1">Grocery</option>
                    <option value="2">Housing</option>
                    <option value="3">Bills</option>
                    <option value="4">Entertainment</option>
                    <option value="5">Gas</option>
                    <option value="6">Miscellaneous</option>
                </select>
            </div>
            <h5>Description</h5>
            <div class="input-field">
                <input name="Description" placeholder=" Enter item description..." id="purchase-item" style="margin-top: 25px;" type="text" class="validate">
            </div>
            <h5 style="margin-top:25px;">Price</h5>
            <div class="input-field">
                <i class="material-icons prefix" style="margin-top:30px; color:#b2dfdb;">attach_money</i>
                <input name="Cost" placeholder="0" id="budget-limit-amount" style="margin-top: 25px;" type="number" step="0.01" class="validate">
                @Html.Hidden("Email", user)
                @Html.Hidden("Description", "Description")
                @Html.Hidden("Cost", "Cost")
                @Html.Hidden("TypeOfBudget", "TypeOfBudget")
                @Html.Hidden("Date", DateTime.Now)
                @Html.Hidden("Month", budgetMonth)
                <div style="margin-top:23px;"><button type="submit" class="btn-floating btn-large waves-effect waves-light;" style="background-color:#cfd8dc !important;"><i class="material-icons" style="font-weight:bold; color: #212121 !important;">add</i></button>@*<input type="submit" style="cursor:pointer" value="ADD" class="grey-button" />*@</div>
            </div>
        </form>
        <div class="col s12 m12 l4"></div>
    </div>
</div>

@*View Transactions*@
<div class="container center" style="margin-top:35px; margin-bottom:250px;">
    <h5 style="margin-top:55px; margin-bottom:25px; font-weight:bold; color:#cfd8dc; text-align:center">Past Transactions</h5>
    <a class="waves-effect waves-light lightBrown-hover btn-large sharpCorners grey darken-4" id="transaction-btnG" style="font-weight:bold; font-size:20px; margin-top:10px;"><i class="material-icons left">local_dining</i>Grocery</a>
        <table class="table" id="transactionsG" align="center" style="display:none; width:25%; margin-bottom:25px;">
            <tr style="border-bottom: 1px dotted #cfd8dc">
                <th>Date</th>
                <th>Description</th>
                <th>Price</th>
                <th></th>
            </tr>
            @{ int count = 0;}
            @foreach (var item in Model.Where(x => Convert.ToInt32(x.TypeOfBudget) == 1).OrderBy(x => x.Date))
            {               
                count += 1;
                <tr style="border-bottom: 1px dotted #cfd8dc">
                    <td>@item.Date.ToString("MM/dd/yyyy")</td>
                    <td>@item.Description</td>
                    <td>$@item.Cost</td>
                    <td><a href='@Url.Action("DeleteTransaction", "Budgets", new { id = item.TransactionId })'><i class="material-icons left trashcan-icon">delete</i></a></td>
                </tr>            
            }

            @if (count == 0)
            {
                <tr>
                    <th>No Transactions...</th>
                </tr>
            }
        </table>
    <a class="waves-effect waves-light lightBrown-hover btn-large sharpCorners grey darken-4" id="transaction-btnH" style="font-weight:bold; font-size:20px; margin-top:10px;"><i class="material-icons left">home</i>Housing</a>
    <table class="table" id="transactionsH" align="center" style="display:none; width:25%; margin-bottom:25px;">
        <tr style="border-bottom: 1px dotted #cfd8dc">
            <th>Date</th>
            <th>Description</th>
            <th>Price</th>
            <th></th>
        </tr>
        @{ int countH = 0;}
        @foreach (var item in Model.Where(x => Convert.ToInt32(x.TypeOfBudget) == 2).OrderBy(x => x.Date))
        {          
            countH += 1;
            <tr style="border-bottom: 1px dotted #cfd8dc">
                <td>@item.Date.ToString("MM/dd/yyyy")</td>
                <td>@item.Description</td>
                <td>$@item.Cost</td>
                <td><a href='@Url.Action("DeleteTransaction", "Budgets", new { id = item.TransactionId })'><i class="material-icons left trashcan-icon">delete</i></a></td>
            </tr>
        }
        @if (countH == 0)
        {
            <tr>
                <th>No Transactions...</th>
            </tr>
        }
    </table>

    <a class="waves-effect waves-light btn-large lightBrown-hover sharpCorners grey darken-4" id="transaction-btnB" style="font-weight:bold; font-size:20px; margin-top:10px;"><i class="material-icons left">monetization_on</i>Bills</a>
    <table class="table" id="transactionsB" align="center" style="display:none; width:25%; margin-bottom:25px;">
        <tr style="border-bottom: 1px dotted #cfd8dc">
            <th>Date</th>
            <th>Description</th>
            <th>Price</th>
            <th></th>
        </tr>
        @{ int countB = 0;}
        @foreach (var item in Model.Where(x => Convert.ToInt32(x.TypeOfBudget) == 3).OrderBy(x => x.Date))
        {
            countB += 1;
            <tr style="border-bottom: 1px dotted #cfd8dc">
                <td>@item.Date.ToString("MM/dd/yyyy")</td>
                <td>@item.Description</td>
                <td>$@item.Cost</td>
                <td><a href='@Url.Action("DeleteTransaction", "Budgets", new { id = item.TransactionId })'><i class="material-icons left trashcan-icon">delete</i></a></td>
            </tr>
        }
        @if (countB == 0)
        {
            <tr>
                <th>No Transactions...</th>
            </tr>
        }
    </table>

    <a class="waves-effect waves-light btn-large lightBrown-hover sharpCorners grey darken-4" id="transaction-btnE" style="font-weight:bold; font-size:20px; margin-top:10px;"><i class="material-icons left">local_activity</i>Entertainment</a>
    <table class="table" id="transactionsE" align="center" style="display:none; width:25%; margin-bottom:25px;">
        <tr style="border-bottom: 1px dotted #cfd8dc">
            <th>Date</th>
            <th>Description</th>
            <th>Price</th>
            <th></th>
        </tr>
        @{ int countE = 0;}
        @foreach (var item in Model.Where(x => Convert.ToInt32(x.TypeOfBudget) == 4).OrderBy(x => x.Date))
        {           
            countE += 1;
            <tr style="border-bottom: 1px dotted #cfd8dc">
                <td>@item.Date.ToString("MM/dd/yyyy")</td>
                <td>@item.Description</td>
                <td>$@item.Cost</td>
                <td><a href='@Url.Action("DeleteTransaction", "Budgets", new { id = item.TransactionId })'><i class="material-icons left trashcan-icon">delete</i></a></td>
            </tr>
        }
        @if (countE == 0)
        {
            <tr>
                <th>No Transactions...</th>
            </tr>
        }
    </table>

    <a class="waves-effect waves-light btn-large lightBrown-hover sharpCorners grey darken-4" id="transaction-btnGas" style="font-weight:bold; font-size:20px; margin-top:10px;"><i class="material-icons left">drive_eta</i>Gas</a>
    <table class="table" id="transactionsGas" align="center" style="display:none; width:25%; margin-bottom:25px;">
        <tr style="border-bottom: 1px dotted #cfd8dc">
            <th>Date</th>
            <th>Description</th>
            <th>Price</th>
            <th></th>
        </tr>
        @{ int countGas = 0;}
        @foreach (var item in Model.Where(x => Convert.ToInt32(x.TypeOfBudget) == 5).OrderBy(x => x.Date))
        {
            countGas += 1;
            <tr style="border-bottom: 1px dotted #cfd8dc">
                <td>@item.Date.ToString("MM/dd/yyyy")</td>
                <td>@item.Description</td>
                <td>$@item.Cost</td>
                <td><a href='@Url.Action("DeleteTransaction", "Budgets", new { id = item.TransactionId })'><i class="material-icons left trashcan-icon">delete</i></a></td>
            </tr>
        }
        @if (countGas == 0)
        {
            <tr>
                <th>No Transactions...</th>
            </tr>
        }
    </table>

    <a class="waves-effect waves-light btn-large lightBrown-hover sharpCorners grey darken-4" id="transaction-btnM" style="font-weight:bold; font-size:20px; margin-top:10px;"><i class="material-icons left">gesture</i>Miscellaneous</a>
    <table class="table" id="transactionsM" align="center" style="display:none; width:25%; margin-bottom:15px;">
        <tr style="border-bottom: 1px dotted #cfd8dc">
            <th>Date</th>
            <th>Description</th>
            <th>Price</th>
            <th></th>
        </tr>
        @{ int countM = 0;}
        @foreach (var item in Model.Where(x => Convert.ToInt32(x.TypeOfBudget) == 6).OrderBy(x => x.Date))
        {            
            countM += 1;
            <tr style="border-bottom: 1px dotted #cfd8dc">
                <td>@item.Date.ToString("MM/dd/yyyy")</td>
                <td>@item.Description</td>
                <td>$@item.Cost</td>
                <td><a href='@Url.Action("DeleteTransaction", "Budgets", new { id = item.TransactionId })'><i class="material-icons left trashcan-icon">delete</i></a></td>
            </tr>
        }
        @if (countM == 0)
        {
            <tr>
                <th>No Transactions...</th>
            </tr>
        }
    </table>
</div>


<style>

    .dropdown-content li > a, .dropdown-content li > span {
        color: #cfd8dc !important;
        font-size: 20px !important;
        font-weight: bold;
        text-align: center;
        background-color: #212121 !important;
    }

    .dropdown-content li > a, .dropdown-content li > span:hover {
        background-color: #cfd8dc !important;
        color: #212121 !important;
    }

    .select-dropdown li.disabled, .select-dropdown li.disabled > span, .select-dropdown li.optgroup {
        color: black !important;
        font-weight: bold;
        text-align: center;
    }

    .select-wrapper input.select-dropdown {
        border-bottom: none!important; 
    }

    .select-wrapper input.select-dropdown {
        color: #cfd8dc !important;
        font-weight: bold !important;
        font-size: 25px;
        text-align: center;
        background-color: black !important;
        padding-top: 10px;
       padding-bottom: 10px;
    }

    .select-wrapper input.select-dropdown:hover {
        background-color: black !important;
        color: #81cac4 !important;
    }

    .trashcan-icon{
        color: #cfd8dc !important;

    }

    .trashcan-icon:hover {
        color: #81cac4 !important;
    }

    .lightBrown-hover:hover {
        background-color: #424242 !important;
    }

</style>

<script>
    $(document).ready(function () {
        //$('.dropdown-trigger').dropdown();
        $('select').formSelect();
        //var instance = M.FormSelect.getInstance(elem);
        Transactions();
    });

    //Show/Hide transactions based on category
    function Transactions() {
        $('#transaction-btnG').on('click', function () {
            $('#transactionsG').toggle();
        });

        $('#transaction-btnH').on('click', function () {
            $('#transactionsH').toggle();
        });

        $('#transaction-btnB').on('click', function () {
            $('#transactionsB').toggle();
        });
    
        $('#transaction-btnE').on('click', function () {
           $('#transactionsE').toggle();
        });
    
        $('#transaction-btnGas').on('click', function () {
           $('#transactionsGas').toggle();
        });
    
        $('#transaction-btnM').on('click', function () {
           $('#transactionsM').toggle();
        });
    }

    var clickedG = true;
    var clickedH = true;
    var clickedB = true;
    var clickedE = true;
    var clickedGas = true;
    var clickedM = true;


   $('#transaction-btnG').click(function () {
        if (clickedG) {
            $(this).css("cssText", "color: #81cac4 !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedG = false;
        } else {
            $(this).css("cssText", "color: #cfd8dc !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedG = true;
        }
    });
   
    $('#transaction-btnH').click(function () {
            if (clickedH) {
                $(this).css("cssText", "color: #81cac4 !important; font-weight:bold; font-size:20px; margin-top:10px;");
                clickedH = false;
            } else {
                $(this).css("cssText", "color: #cfd8dc !important; font-weight:bold; font-size:20px; margin-top:10px;");
                clickedH = true;
            }
        });

    $('#transaction-btnB').click(function () {
        if (clickedB) {
            $(this).css("cssText", "color: #81cac4 !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedB = false;
        } else {
            $(this).css("cssText", "color: #cfd8dc !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedB = true;
        }
    });

    $('#transaction-btnE').click(function () {
        if (clickedE) {
            $(this).css("cssText", "color: #81cac4 !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedE = false;
        } else {
            $(this).css("cssText", "color: #cfd8dc !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedE = true;
        }
    });

    $('#transaction-btnGas').click(function () {
        if (clickedGas) {
            $(this).css("cssText", "color: #81cac4 !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedGas = false;
        } else {
            $(this).css("cssText", "color: #cfd8dc !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedGas = true;
        }
    });

    $('#transaction-btnM').click(function () {
        if (clickedM) {
            $(this).css("cssText", "color: #81cac4 !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedM = false;
        } else {
            $(this).css("cssText", "color: #cfd8dc !important; font-weight:bold; font-size:20px; margin-top:10px;");
            clickedM = true;
        }
    });

    
</script>


